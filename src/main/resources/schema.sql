drop table if exists comments cascade;
drop table if exists bookings cascade;
drop table if exists users cascade;
drop table if exists items cascade;
drop table if exists requests cascade;

create table users
(
    id    integer generated by default as identity primary key,
    name  varchar(255) not null,
    email varchar(320) not null,
    constraint unique_user_email unique (email)
);

create table requests
(
    id           integer generated by default as identity primary key,
    description  varchar not null,
    requester_id integer references users (id) on delete cascade,
    created timestamp with time zone
);

create table items
(
    id          integer generated by default as identity primary key,
    name        varchar(255)         not null,
    description varchar              not null,
    available   boolean default true not null,
    owner_id    integer references users (id) on delete cascade,
    request_id  integer references requests (id) on delete cascade
);

create table bookings
(
    id         integer generated by default as identity primary key,
    date_start timestamp without time zone not null,
    date_end   timestamp without time zone not null,
    status     varchar(50)                 not null,
    item_id    integer references items (id) on delete cascade,
    booker_id  integer references users (id) on delete cascade
);

create table comments
(
    id           integer generated by default as identity primary key,
    text         varchar not null,
    item_id      integer references items (id) on delete cascade,
    author_id    integer references users (id) on delete cascade,
    posting_date timestamp without time zone default now()
);